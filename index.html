<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Cookie Clicker</title>
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<link rel="stylesheet" href="style.css">
	<style>
		:root {
			--bg: beige;
			--text: #0f172a;
			--muted: #334155;
			--panel: #ffffffcc;
			--accent: #0ea5e9;
			--accent-hover: #0284c7;
		}
		html, body {
			background-color: var(--bg);
			background-image: var(--bg-image);
			background-size: cover;
			background-position: center;
			background-repeat: no-repeat;
			background-attachment: fixed;
			color: var(--text);
			height: 100%;
			min-height: 100vh;
			overflow: hidden;
		}

		.main-container {
			height: 100vh;
			display: flex;
			padding: 20px;
			gap: 20px;
		}
		.left-panel {
			flex: 0 0 520px;
			display: flex;
			flex-direction: column;
		}
		.right-panel {
			flex: 1;
			display: flex;
			flex-direction: column;
			overflow: hidden;
			align-items: flex-end;
		}
		.scrollable-list {
			flex: 1;
			overflow-y: auto;
			padding-right: 10px;
		}
		.scrollable-list::-webkit-scrollbar {
			width: 8px;
		}
		.scrollable-list::-webkit-scrollbar-track {
			background: rgba(0,0,0,0.1);
			border-radius: 4px;
		}
		.scrollable-list::-webkit-scrollbar-thumb {
			background: rgba(0,0,0,0.3);
			border-radius: 4px;
		}
		.scrollable-list::-webkit-scrollbar-thumb:hover {
			background: rgba(0,0,0,0.5);
		}

		.title {
			font-family: system-ui, sans-serif;
			color: var(--text);
			margin-bottom: 16px;
		}

		.counter {
			font-family: system-ui, sans-serif;
			font-size: 32px;
			font-weight: 700;
			color: var(--text);
			margin: 16px 0;
		}

		.cookie-btn {
			background: transparent;
			border: none;
			padding: 0;
			cursor: pointer;
		}

		.cookie-img {
			display: block;
			width: 240px;
			height: 240px;
			object-fit: contain;
			margin: 0 auto;
			transition: transform 0.08s ease;
		}
		.cookie-img.pressed { transform: scale(0.92); }
		.cookie-btn:active .cookie-img { transform: scale(0.92); }

		.section-title {
			font-family: system-ui, sans-serif;
			font-size: 18px;
			font-weight: 700;
			color: var(--text);
			margin: 0 0 8px 0;
		}
		.list {
			display: flex;
			flex-direction: column;
			gap: 4px;
			text-align: left;
		}
		.card {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 6px 10px;
			border-radius: 8px;
			background: var(--panel);
			box-shadow: 0 1px 3px rgba(0,0,0,.08);
		}
		.card h3 {
			margin: 0 0 4px 0;
			font-family: system-ui, sans-serif;
			font-size: 16px;
			color: var(--text);
		}
		.card p {
			margin: 0;
			font-family: system-ui, sans-serif;
			font-size: 13px;
			color: var(--muted);
		}
		.small {
			font-size: 12px;
			color: var(--muted);
		}
		.btn {
			border: none;
			background: var(--accent);
			color: var(--bg);
			border-radius: 6px;
			padding: 8px 10px;
			cursor: pointer;
			font-family: system-ui, sans-serif;
			font-weight: 600;
			transition: background-color .2s ease;
		}
		.btn:disabled {
			opacity: .5;
			cursor: not-allowed;
			background: rgba(148, 163, 184, 0.6);
			color: var(--text);
		}
		.btn:not(:disabled):hover {
			background: var(--accent-hover);
		}
		.select {
			width: 100%;
			max-width: 320px;
			margin: 0 auto;
			padding: 8px 10px;
			border-radius: 6px;
			border: 1px solid rgba(148,163,184,.6);
			font-family: system-ui, sans-serif;
		}
		.theme-picker {
			display: flex;
			flex-direction: column;
			gap: 6px;
			align-items: center;
			margin-bottom: 8px;
		}
		.unlock-list {
			list-style: none;
			padding: 0;
			margin: 0;
			display: flex;
			flex-direction: column;
			gap: 8px;
		}
		.unlock-card {
			background: var(--panel);
			padding: 10px 12px;
			border-radius: 8px;
			box-shadow: 0 1px 3px rgba(0,0,0,.08);
			font-family: system-ui, sans-serif;
			color: var(--text);
		}
		.unlock-card span {
			display: block;
			font-size: 12px;
			color: var(--muted);
			margin-top: 4px;
		}
		.buy-upgrade, .buy-producer {
			padding: 0.2rem 0.6rem !important;
			min-width: 52px;
		}
		.right-panel .list { width: 100%; max-width: 560px; margin-left: auto; }
		.right-panel .section-title { width: 100%; max-width: 560px; margin-left: auto; }
		.right-panel .scrollable-list { padding-right: 0; }
		.right-panel .card { width: 100%; }
		.right-panel .mb-3 { width: 100%; max-width: 560px; margin-left: auto; }
		.right-panel .right-header { position: sticky; top: 0; z-index: 10; padding-bottom: 8px; background: transparent; width: 100%; max-width: 560px; margin-left: auto; }
		/* Ensure text colors follow theme variables */
		body { color: var(--text); }
		.card-title, .card-text { color: var(--text); }
		.small { color: var(--muted); }
		.text-muted { color: var(--muted) !important; }
		.text-primary { color: var(--accent) !important; }
		.form-select { color: var(--text); background-color: var(--panel); }
		.modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 1000; }
		.modal-backdrop.open { display: flex; }
		.modal-panel { background: var(--panel); border-radius: 10px; width: min(92vw, 640px); max-height: 80vh; overflow: hidden; display: flex; flex-direction: column; }
		.modal-header { padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; }
		.modal-body { padding: 12px 16px; overflow: auto; }
		.unlock-item { border-radius: 8px; padding: 10px 12px; background: var(--panel); margin-bottom: 8px; border-left: 4px solid #6b7280; }
		.unlock-item.unlocked { border-left-color: #16a34a; }
		.unlock-item.locked { opacity: .6; }
	</style>
</head>
<body>
	<div class="main-container">
		<!-- Left Panel: Cookie Clicker -->
		<div class="left-panel">
			<div class="text-center flex-grow-1 d-flex flex-column justify-content-center">
				<h1 class="title mb-3">Cookie Clicker</h1>
				<div id="cookies" class="counter">0</div>
				<div id="stats" class="text-muted small mb-3">+1/klik â€¢ 0/s</div>
				<button id="cookieButton" type="button" aria-label="Cookie" class="cookie-btn">
					<img id="cookieImage" src="assets/Cookie_foto-removebg-preview.png" alt="Cookie" class="cookie-img">
				</button>
			</div>

			<div class="mt-auto">
				<div class="d-flex justify-content-between align-items-center mb-1" style="max-width: 520px; margin: 0 auto;">
					<div class="section-title mb-0">Ontgrendelingen</div>
					<button id="openAchievements" class="btn btn-secondary btn-sm">Bekijk alle</button>
				</div>
				<div class="scrollable-list" style="max-height: 200px; display: none;">
					<ul id="unlockList" class="unlock-list"></ul>
				</div>
			</div>
		</div>

		<!-- Right Panel: Upgrades and Producers -->
		<div class="right-panel">
			<div class="right-header d-flex justify-content-between align-items-start w-100">
				<div>
					<select id="themeSelect" class="form-select form-select-sm"></select>
					<div class="small text-muted mt-1">Ontgrendel nieuwe thema's door te spelen.</div>
				</div>
				<button id="resetBtn" class="btn btn-danger btn-sm">Reset</button>
			</div>
			<div class="section-title mb-2">Upgrades</div>
			<div id="upgradeList" class="scrollable-list list"></div>
			
			<div class="section-title mb-2 mt-3">Producers</div>
			<div id="producerList" class="scrollable-list list"></div>
		</div>
	</div>

	<script src="main.js"></script>
	<script>
		(function(){
			const btn = document.getElementById('resetBtn');
			if (btn) {
				btn.addEventListener('click', function(){
					if (!confirm('Weet je zeker dat je al je voortgang wilt resetten? Dit kan niet ongedaan worden gemaakt.')) return;
					try { localStorage.removeItem('cookieclicker_state_v1'); } catch(e){}
					location.reload();
				});
			}
			const defs = [
				{ id: 'unlock_starter', name: 'Startende Bakker', description: 'Bak in totaal 100 koekjes.' },
				{ id: 'unlock_click_master', name: 'Klik Meester', description: 'Bereik minstens +10 per klik.' },
				{ id: 'unlock_producer_guru', name: 'Productie Guru', description: 'Bezit 25 automatische producers.' },
				{ id: 'unlock_theme_midnight', name: 'Nachtploeg', description: 'Bak in totaal 1.000 koekjes om het Midnight-thema te ontgrendelen.' },
				{ id: 'unlock_theme_forest', name: 'Boswachter', description: 'Bezit 5 boerderijen om het Forest-thema te ontgrendelen.' }
			];
			function getUnlocks(){
				try { const raw = localStorage.getItem('cookieclicker_state_v1'); if (!raw) return []; const s = JSON.parse(raw); return Array.isArray(s.unlocks) ? s.unlocks : []; } catch(e){ return []; }
			}
			function renderAllUnlocks(){
				const unlocked = new Set(getUnlocks());
				const list = document.getElementById('allUnlocksList');
				if (!list) return;
				list.innerHTML = '';
				for (const d of defs){
					const li = document.createElement('li');
					const isUnlocked = unlocked.has(d.id);
					li.className = 'unlock-item ' + (isUnlocked ? 'unlocked' : 'locked');
					li.innerHTML = '<div class="d-flex flex-column">'
						+ '<strong class="card-title mb-1">' + d.name + '</strong>'
						+ '<span class="small">' + d.description + '</span>'
						+ '</div>';
					list.appendChild(li);
				}
			}
			const openBtn = document.getElementById('openAchievements');
			if (openBtn) {
				openBtn.addEventListener('click', function(){
					renderAllUnlocks();
					const m = document.getElementById('achievementsModal');
					if (m) m.classList.add('open');
				});
			}
			// Event delegation for closing (works even if elements are added later)
			document.addEventListener('click', function(e){
				if (e.target && e.target.id === 'closeAchievements') {
					const m = document.getElementById('achievementsModal');
					if (m) m.classList.remove('open');
				}
				if (e.target && e.target.id === 'achievementsModal') {
					e.target.classList.remove('open');
				}
			});
			const themeSelect = document.getElementById('themeSelect');
			function themeUnlocks() {
				try { const raw = localStorage.getItem('cookieclicker_state_v1'); if (!raw) return new Set(); const s = JSON.parse(raw); return new Set(Array.isArray(s.unlocks) ? s.unlocks : []); } catch(e){ return new Set(); }
			}
			function syncThemeOptions() {
				if (!themeSelect || !window.ThemeManager) return;
				const unlocked = themeUnlocks();
				for (const opt of Array.from(themeSelect.options)) {
					const theme = ThemeManager.THEMES.find(t => t.id === opt.value);
					if (!theme) continue;
					const isUnlocked = !theme.unlockId || unlocked.has(theme.unlockId);
					opt.disabled = !isUnlocked;
					opt.textContent = isUnlocked ? theme.name : `${theme.name} (vergrendeld)`;
				}
			}
			let lastThemeValue = themeSelect ? themeSelect.value : null;
			if (themeSelect) {
				themeSelect.addEventListener('change', function(){
					syncThemeOptions();
					const opt = themeSelect.options[themeSelect.selectedIndex];
					if (opt && opt.disabled) {
						alert('Dit thema is nog vergrendeld.');
						themeSelect.value = lastThemeValue;
						return;
					}
					lastThemeValue = themeSelect.value;
				});
				const mo = new MutationObserver(syncThemeOptions);
				mo.observe(themeSelect, { childList: true });
				syncThemeOptions();
			}
		})();
	</script>
	<div id="achievementsModal" class="modal-backdrop">
		<div class="modal-panel">
			<div class="modal-header">
				<h5 class="mb-0">Ontgrendelingen</h5>
				<button id="closeAchievements" class="btn btn-secondary btn-sm">Sluiten</button>
			</div>
			<div class="modal-body">
				<ul id="allUnlocksList" class="list-unstyled mb-0"></ul>
			</div>
		</div>
	</div>
</body>
</html>

